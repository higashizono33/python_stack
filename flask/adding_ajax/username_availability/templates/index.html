<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login and Registration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            $('#username').keyup(function(){
                var data = $("#regForm").serialize()
                $.ajax({
                    method: "POST",
                    url: "/username",
                    data: data
                })
                .done(function(res){
                    $('#usernameMsg').html(res)
                })
            })
        })
    </script>
</head>
<body>
    <div class="container pt-5 g-4">
        <div class="row">
        {% with messages = get_flashed_messages(with_categories=true) %}
        <h1 class="mb-4"><mark>Login and Registration</mark></h1>
        <div class="col-6">
            <h2 class="mb-4">Register Here!</h2>
            <form action="/register" method="POST" id="regForm">
                <div class="mb-3 row">
                    <label for="username" class="col-sm-3 col-form-label">Username:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="username" name="username">
                        <div id="usernameMsg">
                        </div>
                        <!-- {% if messages %}
                            {% for category, message in messages %}
                                {% if category == "username" %}
                                <span class="text-danger">{{message}}</span>
                                {% endif %}
                            {% endfor %}
                        {% endif %} -->
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="first_name" class="col-sm-3 col-form-label">First Name:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="first_name" name="first_name">
                        {% if messages %}
                            {% for category, message in messages %}
                                {% if category == "first_name" %}
                                <span class="text-danger">{{message}}</span>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="last_name" class="col-sm-3 col-form-label">Last Name:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="last_name" name="last_name">
                        {% if messages %}
                            {% for category, message in messages %}
                                {% if category == 'last_name' %}
                                <span class="text-danger">{{message}}</span>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="email" class="col-sm-3 col-form-label">Email:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="email" name="email">
                        {% if messages %}
                            {% for category, message in messages %}
                                {% if category == 'email' %}
                                <span class="text-danger">{{message}}</span>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="password" class="col-sm-3 col-form-label">Password:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="password" name="password">
                        {% if messages %}
                            {% for category, message in messages %}
                                {% if category == 'password' %}
                                <span class="text-danger">{{message}}</span>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="confirm_pw" class="col-sm-3 col-form-label">Confirm password:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="confirm_pw" name="confirm_pw">
                        {% if messages %}
                            {% for category, message in messages %}
                                {% if category == 'confirm_pw' %}
                                <span class="text-danger">{{message}}</span>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="d-flex justify-content-end">
                    <button class="btn btn-primary px-5">Submit</button>
                </div>
            </form>
        </div>
        <div class="col-6">
            <h2 class="mb-4 d-inline">Login Here!</h2>
            {% if messages %}
                {% for category, message in messages %}
                    {% if category == 'login' %}
                    <span class="text-danger d-inline ms-5">{{message}}</span>
                    {% endif %}
                {% endfor %}
            {% endif %}
            <form action="/login" method="POST">
                <div class="mb-3 mt-4 row">
                    <label for="email" class="col-sm-3 col-form-label">Email:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="email" name="email">
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="password" class="col-sm-3 col-form-label">Password:</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="password" name="password">
                    </div>
                </div>
                <div class="d-flex justify-content-end">
                    <button class="btn btn-primary px-5">Submit</button>
                </div>
            </form>
        </div>
        {% endwith %}
        </div>
    </div>
</body>
</html>